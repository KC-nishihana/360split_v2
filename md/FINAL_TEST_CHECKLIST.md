# 360Split ステレオ機能 最終テストチェックリスト

**実装完了日**: 2026-02-12
**テスト実施日**: ___________
**テスター**: ___________

---

## 📋 テスト概要

このチェックリストは、360Split のステレオ機能実装が正しく動作することを確認するためのものです。

### テスト環境

- [ ] OS: macOS / Ubuntu / Windows（該当するものに✓）
- [ ] Python バージョン: _______
- [ ] ffmpeg バージョン: _______
- [ ] OSV ファイル: 準備済み

---

## ✅ テストチェックリスト

### セクション 1: 環境確認

#### 1.1 必須ソフトウェア

- [ ] Python 3.8 以上がインストールされている
- [ ] ffmpeg がインストールされている
  ```bash
  which ffmpeg  # パスが表示される
  ffmpeg -version  # バージョンが表示される
  ```
- [ ] 必要な Python パッケージがインストールされている
  ```bash
  pip list | grep -E "PySide6|opencv-python|numpy"
  ```

#### 1.2 OSV ファイルの準備

- [ ] テスト用 OSV ファイルが存在する
- [ ] OSV ファイルのストリーム数が2つである
  ```bash
  ffprobe test.osv | grep "Stream"
  # Stream #0:0 と Stream #0:1 が表示される
  ```

---

### セクション 2: CLI テスト

#### 2.1 基本的な OSV 読み込み

```bash
python main.py --cli test.osv --output test_output/
```

**確認項目：**
- [ ] エラーなく実行完了
- [ ] "OSV（ステレオ）ファイルを検出しました" と表示される
- [ ] "ステレオストリームを分離しました" と表示される
- [ ] 一時ファイルが `temp_streams/` に作成される

#### 2.2 ステレオペア出力の確認

```bash
ls -l test_output/
```

**確認項目：**
- [ ] `*_L.png` ファイルが存在する
- [ ] `*_R.png` ファイルが存在する
- [ ] 左右のファイル数が同じ
- [ ] `keyframe_metadata.json` が存在する

**サンプル出力：**
```
keyframe_000001_L.png
keyframe_000001_R.png
keyframe_000050_L.png
keyframe_000050_R.png
keyframe_metadata.json
```

#### 2.3 プリセットテスト

```bash
# 屋外プリセット
python main.py --cli test.osv --preset outdoor --output outdoor_output/

# 屋内プリセット
python main.py --cli test.osv --preset indoor --output indoor_output/
```

**確認項目：**
- [ ] 屋外プリセットが正常動作
- [ ] 屋内プリセットが正常動作
- [ ] ログに "プリセット '...' を適用しました" と表示される

#### 2.4 360度処理との組み合わせ

```bash
python main.py --cli test.osv --equirectangular --output eq_output/
```

**確認項目：**
- [ ] Equirectangular 処理が動作
- [ ] ステレオペア出力が正常
- [ ] エラーが発生しない

---

### セクション 3: GUI テスト

#### 3.1 GUI 起動

```bash
python main.py
```

**確認項目：**
- [ ] GUI が正常に起動
- [ ] ウィンドウが表示される
- [ ] ステータスバーに "準備完了" と表示される

#### 3.2 OSV ファイルの読み込み（メニューから）

1. **ファイル** → **開く** をクリック
2. OSV ファイルを選択
3. **開く** をクリック

**確認項目：**
- [ ] ファイル選択ダイアログに `.osv` が表示される
- [ ] OSV ファイルが選択できる
- [ ] 読み込み成功メッセージが表示される
- [ ] ステータスバーに "OSV - ステレオ" と表示される
- [ ] ビデオプレーヤーに映像が表示される

#### 3.3 OSV ファイルの読み込み（ドラッグ＆ドロップ）

1. OSV ファイルを GUI ウィンドウにドラッグ
2. ドロップ

**確認項目：**
- [ ] ドラッグ＆ドロップが受け付けられる
- [ ] 読み込みが成功する
- [ ] ステータスバーに "ステレオ表示可能" と表示される

#### 3.4 ステレオ表示モードの確認

**確認項目：**
- [ ] **ステレオ:** コンボボックスが表示される
- [ ] コンボボックスが有効である
- [ ] 5つの表示モードが選択できる
  - [ ] Side-by-Side
  - [ ] アナグリフ
  - [ ] 左のみ
  - [ ] 右のみ
  - [ ] L/R切替

#### 3.5 Side-by-Side 表示テスト

1. **ステレオ:** コンボボックスで **Side-by-Side** を選択

**確認項目：**
- [ ] 左右の映像が並んで表示される
- [ ] 中央に緑の境界線が表示される
- [ ] "LEFT" と "RIGHT" のラベルが表示される
- [ ] 表示が即座に更新される

#### 3.6 アナグリフ表示テスト

1. **ステレオ:** コンボボックスで **アナグリフ** を選択

**確認項目：**
- [ ] 赤青が重なった映像が表示される
- [ ] グレースケール処理されている
- [ ] 表示が即座に更新される

#### 3.7 左のみ・右のみ表示テスト

1. **ステレオ:** コンボボックスで **左のみ** を選択
2. **ステレオ:** コンボボックスで **右のみ** を選択

**確認項目：**
- [ ] 左のみで左目ストリームが表示される
- [ ] 右のみで右目ストリームが表示される
- [ ] 切り替えがスムーズ

#### 3.8 L/R 切り替え表示テスト

1. **ステレオ:** コンボボックスで **L/R切替** を選択
2. 数秒間観察

**確認項目：**
- [ ] 左右が自動的に切り替わる
- [ ] 約500ms 間隔で切り替わる
- [ ] 切り替え時にエラーが発生しない

#### 3.9 再生機能テスト

**確認項目：**
- [ ] **▶ 再生** ボタンで再生開始
- [ ] **⏸ 停止** ボタンで停止
- [ ] **◀** ボタンで前のフレーム
- [ ] **▶** ボタンで次のフレーム
- [ ] スライダーでシーク可能
- [ ] フレーム番号入力でジャンプ可能

#### 3.10 ステレオ表示中の再生

1. Side-by-Side 表示を選択
2. 再生ボタンをクリック

**確認項目：**
- [ ] ステレオ表示のまま再生される
- [ ] フレームレートが安定している
- [ ] 左右が同期している

#### 3.11 表示モード切り替え中の再生

1. 再生中に表示モードを変更

**確認項目：**
- [ ] 再生が継続される
- [ ] 表示モードが即座に切り替わる
- [ ] クラッシュしない

#### 3.12 グリッドオーバーレイ（360度動画の場合）

1. **Grid OFF** ボタンをクリック

**確認項目：**
- [ ] グリッド線が表示される
- [ ] ステレオ表示と併用できる
- [ ] 再度クリックで非表示になる

#### 3.13 キーフレーム解析テスト

1. **解析** → **フル解析 (Stage 1+2)** をクリック
2. 解析完了まで待機

**確認項目：**
- [ ] 進捗バーが表示される
- [ ] 進捗が正常に更新される
- [ ] 解析が完了する
- [ ] タイムラインにキーフレームマーカーが表示される
- [ ] キーフレーム一覧にキーフレームが表示される
- [ ] ログに "ステレオモード（OSV）でキーフレーム選択を実行" と表示される

#### 3.14 キーフレームのプレビュー

1. キーフレーム一覧でフレームをクリック

**確認項目：**
- [ ] ビデオプレーヤーがそのフレームにジャンプ
- [ ] ステレオ表示が維持される
- [ ] "✅ Keyframe" インジケータが表示される

#### 3.15 エクスポートテスト

1. **ファイル** → **キーフレームをエクスポート** をクリック
2. エクスポート設定を確認
3. **エクスポート** をクリック

**確認項目：**
- [ ] エクスポートダイアログが開く
- [ ] 出力ディレクトリが選択できる
- [ ] 画像フォーマットが選択できる
- [ ] エクスポートが開始される
- [ ] 進捗バーが表示される
- [ ] ステータスバーに "ステレオペア出力モード（L/R）" と表示される
- [ ] エクスポートが完了する
- [ ] 完了メッセージが表示される

#### 3.16 エクスポート結果の確認

1. 出力フォルダを開く

**確認項目：**
- [ ] `*_L.jpg` または `*_L.png` ファイルが存在
- [ ] `*_R.jpg` または `*_R.png` ファイルが存在
- [ ] 左右のファイル数が一致
- [ ] ファイルが正常に開ける
- [ ] 画像内容が正しい

---

### セクション 4: エッジケーステスト

#### 4.1 通常のビデオファイルを開く

1. `.mp4` ファイルを開く

**確認項目：**
- [ ] 通常通り読み込まれる
- [ ] **ステレオ:** コンボボックスが非表示
- [ ] エクスポート時にステレオペアが生成されない
- [ ] 通常の単眼出力が正常

#### 4.2 OSV から通常ビデオへの切り替え

1. OSV ファイルを開く
2. 通常の `.mp4` ファイルを開く

**確認項目：**
- [ ] **ステレオ:** コンボボックスが非表示になる
- [ ] 通常のモノラル表示に戻る
- [ ] メモリリークが発生しない

#### 4.3 通常ビデオから OSV への切り替え

1. 通常の `.mp4` ファイルを開く
2. OSV ファイルを開く

**確認項目：**
- [ ] **ステレオ:** コンボボックスが表示される
- [ ] ステレオ表示が正常に動作
- [ ] メモリリークが発生しない

#### 4.4 大きなファイルのテスト

1. 4K 以上の高解像度 OSV ファイルを開く

**確認項目：**
- [ ] 読み込みに成功する
- [ ] 表示が正常
- [ ] メモリ使用量が許容範囲内
- [ ] パフォーマンスが許容範囲内

#### 4.5 長時間動画のテスト

1. 5分以上の OSV ファイルで解析

**確認項目：**
- [ ] 解析が完了する
- [ ] エクスポートが完了する
- [ ] メモリリークが発生しない
- [ ] クラッシュしない

---

### セクション 5: エラーハンドリングテスト

#### 5.1 ffmpeg が利用不可

1. ffmpeg を一時的に無効化
2. OSV ファイルを開く

**確認項目：**
- [ ] エラーメッセージが表示される
- [ ] クラッシュしない
- [ ] ユーザーに適切な案内が表示される

#### 5.2 不正な OSV ファイル

1. 通常の動画を `.osv` にリネーム
2. そのファイルを開く

**確認項目：**
- [ ] エラーメッセージが表示される
- [ ] クラッシュしない
- [ ] 適切なエラーハンドリング

#### 5.3 破損した OSV ファイル

1. 破損した OSV ファイルを開く

**確認項目：**
- [ ] エラーメッセージが表示される
- [ ] クラッシュしない
- [ ] GUI が応答可能な状態を維持

---

### セクション 6: パフォーマンステスト

#### 6.1 初回読み込み時間

1. OSV ファイルを初めて開く
2. 読み込み時間を計測

**確認項目：**
- [ ] 4K 1分動画: 30秒以内
- [ ] 8K 1分動画: 60秒以内

#### 6.2 2回目以降の読み込み時間

1. 同じ OSV ファイルを再度開く
2. 読み込み時間を計測

**確認項目：**
- [ ] キャッシュが使用される
- [ ] 読み込み時間が大幅に短縮（< 3秒）

#### 6.3 表示モード切り替え速度

1. ステレオ表示モードを切り替える
2. 応答時間を確認

**確認項目：**
- [ ] 即座に切り替わる（< 100ms）
- [ ] フレームレートが安定

#### 6.4 メモリ使用量

1. OSV ファイルを開く
2. システムモニターでメモリ使用量を確認

**確認項目：**
- [ ] ベースライン + 200MB 程度
- [ ] メモリリークがない
- [ ] 長時間使用でも安定

---

### セクション 7: ドキュメントテスト

#### 7.1 ユーザーマニュアル

- [ ] STEREO_USER_MANUAL.md が存在する
- [ ] 内容が正確である
- [ ] 手順が明確である
- [ ] スクリーンショットの説明が適切

#### 7.2 チュートリアル

- [ ] STEREO_TUTORIAL.md が存在する
- [ ] ステップバイステップで実行できる
- [ ] 初心者でも理解できる
- [ ] サンプルコマンドが動作する

#### 7.3 テストガイド

- [ ] OSV_TESTING_GUIDE.md が存在する
- [ ] テスト手順が明確
- [ ] トラブルシューティングが役立つ

#### 7.4 実装状況

- [ ] OSV_IMPLEMENTATION_STATUS.md が存在する
- [ ] 技術詳細が記載されている
- [ ] コード例が正確

---

## 📊 テスト結果サマリ

### 全体スコア

- **セクション 1 (環境確認)**: ___ / ___ 項目 合格
- **セクション 2 (CLI テスト)**: ___ / ___ 項目 合格
- **セクション 3 (GUI テスト)**: ___ / ___ 項目 合格
- **セクション 4 (エッジケース)**: ___ / ___ 項目 合格
- **セクション 5 (エラーハンドリング)**: ___ / ___ 項目 合格
- **セクション 6 (パフォーマンス)**: ___ / ___ 項目 合格
- **セクション 7 (ドキュメント)**: ___ / ___ 項目 合格

**総合スコア**: ___ / ___ 項目 合格 (___%）

---

## 🐛 発見された問題

### 重大な問題（クリティカル）

1. ___________________________________________
2. ___________________________________________

### 中程度の問題

1. ___________________________________________
2. ___________________________________________

### 軽微な問題

1. ___________________________________________
2. ___________________________________________

---

## 💡 改善提案

1. ___________________________________________
2. ___________________________________________
3. ___________________________________________

---

## ✅ テスト完了確認

- [ ] すべてのテスト項目を実施した
- [ ] 発見された問題を記録した
- [ ] テスト結果を関係者に共有した
- [ ] 必要な修正が完了した

---

**テスト完了日**: ___________
**承認者**: ___________
**承認日**: ___________

---

## 📎 添付資料

- テストログ: ___________
- スクリーンショット: ___________
- エラーログ: ___________

---

**作成日**: 2026-02-12
**バージョン**: 1.0.0
